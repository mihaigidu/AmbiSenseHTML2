<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Login - Analizador de Salubridad</title>

  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <!-- Font Awesome -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css"
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />

  <style>
    /* Paleta de colores */
    :root {
      --primary-color: #007D96;
      --secondary-color: #7C719C;
      --background-color: #DFDCE3;
      --text-color: #333333;
      --input-bg-color: #FFFFFF;
      --error-color: #ff3333;
    }

    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: var(--background-color);
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      perspective: 1000px;
    }

    .login-container {
      width: 400px;
      min-height: 480px;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 0.8s ease-in-out, min-height 0.3s ease-in-out;
    }

    .card {
      width: 100%;
      min-height: 450px;
      position: absolute;
      backface-visibility: hidden;
      background: var(--input-bg-color);
      padding: 40px;
      border-radius: 20px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      transition: min-height 0.3s ease-in-out;
    }

    .card-back {
      transform: rotateY(180deg);
    }

    .rotated {
      transform: rotateY(180deg);
    }

    .login-title {
      color: var(--text-color);
      font-weight: bold;
      text-align: center;
      margin-bottom: 20px;
    }

    .form-label {
      font-weight: bold;
      color: var(--text-color);
      cursor: pointer; /* Para indicar que se puede clicar */
    }

    .form-control {
      background-color: var(--input-bg-color);
      border: 1px solid var(--secondary-color);
      color: var(--text-color);
      border-radius: 10px;
      padding: 12px;
    }

    .background-video {
      position: fixed;
      right: 0;
      bottom: 0;
      min-width: 100%;
      min-height: 100%;
      object-fit: cover;
      z-index: -1;
    }

    /* Botón de Ingresar y Registrarse */
    .btn-login {
      background-color: var(--primary-color);
      color: var(--input-bg-color);
      border: none;
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      font-size: 16px;
      margin-top: 10px;
      cursor: pointer;
      background-image: none;
      box-shadow: none;
      transition: none;
    }
    /* Se elimina cualquier cambio en hover, focus o active */
    .btn-login:hover,
    .btn-login:focus,
    .btn-login:active {
      background-color: var(--primary-color) !important;
      background-image: none !important;
      box-shadow: none !important;
      outline: none !important;
    }

    /* Botones de Google y GitHub */
    .btn-google, .btn-github {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      font-size: 16px;
      margin-top: 10px;
      cursor: pointer;
      border: none;
      color: #fff;
      background-image: none;
      box-shadow: none;
      transition: none;
    }

    .btn-google {
      background-color: #db4437;
    }
    .btn-google:hover,
    .btn-google:focus,
    .btn-google:active {
      border: red 1px solid;
      border-radius: 10px;
      background-image: none !important;
      box-shadow: none !important;
      outline: none !important;
    }

    .btn-github {
      background-color: black;
    }
    .btn-github:hover,
    .btn-github:focus,
    .btn-github:active {
      border: black 1px solid;
      border-radius: 10px;
      background-image: none !important;
      box-shadow: none !important;
      outline: none !important;
    }

    .footer-text {
      text-align: center;
      margin-top: 20px;
      color: var(--text-color);
      font-size: 14px;
    }

    .footer-text a {
      color: var(--secondary-color);
      text-decoration: underline;
      cursor: pointer;
    }

    /* Reglas de contraseña y correo: se ocultan por defecto */
    .password-rules,
    .email-rules {
      margin-top: 5px;
      font-size: 0.9rem;
      line-height: 1.3;
      display: none; /* hidden hasta que se haga focus en el input */
    }
    .password-rules p,
    .email-rules p {
      margin: 0;
      color: red; 
      display: block; 
    }
  </style>
</head>
<body>

  <video autoplay loop muted class="background-video">
    <source src="imagenes/VID-20250129-WA0019.mp4" type="video/mp4">
    Tu navegador no soporta videos.
  </video>

  <div class="login-container" id="loginContainer">
    <!-- Cara frontal: Login -->
    <div class="card card-front">
      <form id="loginForm">
        <h2 class="login-title">Iniciar Sesión</h2>

        <!-- Correo Electrónico (Login) -->
        <div class="mb-3">
          <label for="correoElectronico" class="form-label">Correo Electrónico</label>
          <input
            type="text"
            class="form-control"
            id="correoElectronico"
            name="correoElectronico"
            placeholder="Ingrese su Correo Electrónico"
            required
          />
          <!-- Reglas de email para el LOGIN -->
          <div class="email-rules" id="emailRulesLogin">
            <p id="login-emailformat">Debe tener un formato de email válido (usuario@dominio.com)</p>
          </div>
        </div>

        <!-- Contraseña (Login) -->
        <div class="mb-3">
          <label for="password" class="form-label">Contraseña</label>
          <input
            type="password"
            class="form-control"
            id="password"
            name="password"
            placeholder="Ingrese su contraseña"
            required
          />
          <!-- Reglas de contraseña para el LOGIN -->
          <div class="password-rules" id="passwordRulesLogin">
            <p id="login-length">Mínimo 8 caracteres</p>
            <p id="login-uppercase">Al menos 1 mayúscula</p>
            <p id="login-digit">Al menos 1 dígito</p>
          </div>
        </div>

        <button type="submit" class="btn btn-login">Ingresar</button>
        
        <!-- Botón de Google con ícono -->
        <button type="button" class="btn btn-google" id="googleLogin">
          <i class="fa-brands fa-google me-2"></i>
          Iniciar sesión con Google
        </button>
        
        <!-- Botón de GitHub con ícono -->
        <button type="button" class="btn btn-github" id="githubLogin">
          <i class="fa-brands fa-github me-2"></i>
          Iniciar sesión con GitHub
        </button>
      </form>
      <p class="footer-text">
        ¿No tienes una cuenta? <a href="#" id="registerLink">Regístrate aquí</a>
      </p>
    </div>

    <!-- Cara trasera: Registro -->
    <div class="card card-back">
      <form id="registerForm">
        <h2 class="login-title">Regístrate</h2>

        <!-- Nombre Completo -->
        <div class="mb-3">
          <label for="fullname" class="form-label">Nombre Completo</label>
          <input
            type="text"
            class="form-control"
            id="fullname"
            name="fullname"
            placeholder="Ingrese su nombre completo"
            required
          />
        </div>

        <!-- Correo Electrónico (Registro) -->
        <div class="mb-3">
          <label for="email" class="form-label">Correo Electrónico</label>
          <input
            type="email"
            class="form-control"
            id="email"
            name="email"
            placeholder="Ingrese su correo electrónico"
            required
          />
        </div>

        <!-- Contraseña (Registro) -->
        <div class="mb-3">
          <label for="passwordReg" class="form-label">Contraseña</label>
          <input
            type="password"
            class="form-control"
            id="passwordReg"
            name="passwordReg"
            placeholder="Cree una contraseña"
            required
          />
          <!-- Reglas de contraseña para el REGISTRO -->
          <div class="password-rules" id="passwordRulesReg">
            <p id="reg-length">Mínimo 8 caracteres</p>
            <p id="reg-uppercase">Al menos 1 mayúscula</p>
            <p id="reg-digit">Al menos 1 dígito</p>
          </div>
        </div>

        <button type="submit" class="btn btn-login">Registrarse</button>
      </form>
      <p class="footer-text">
        ¿Ya tienes una cuenta? <a href="#" id="backToLoginLink">Inicia sesión aquí</a>
      </p>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const loginContainer = document.getElementById("loginContainer");
      const registerLink = document.getElementById("registerLink");
      const backToLoginLink = document.getElementById("backToLoginLink");

      // Navegación entre Login y Registro
      registerLink.addEventListener("click", function (event) {
        event.preventDefault();
        loginContainer.classList.add("rotated");
        loginContainer.style.minHeight = "550px";
      });
      backToLoginLink.addEventListener("click", function (event) {
        event.preventDefault();
        loginContainer.classList.remove("rotated");
        loginContainer.style.minHeight = "450px";
      });

      // ---- LOGIN ----
      const loginForm = document.getElementById("loginForm");
      const emailLogin = document.getElementById("correoElectronico");
      const passwordLogin = document.getElementById("password");

      // Muestra/oculta las "reglas" del email
      emailLogin.addEventListener("focus", () => {
        document.getElementById("emailRulesLogin").style.display = "block";
      });
      emailLogin.addEventListener("blur", () => {
        document.getElementById("emailRulesLogin").style.display = "none";
      });
      emailLogin.addEventListener("input", () => {
        checkEmailRulesLogin(emailLogin.value);
      });

      // Muestra/oculta las "reglas" de la contraseña
      passwordLogin.addEventListener("focus", () => {
        document.getElementById("passwordRulesLogin").style.display = "block";
      });
      passwordLogin.addEventListener("blur", () => {
        document.getElementById("passwordRulesLogin").style.display = "none";
      });
      passwordLogin.addEventListener("input", () => {
        checkPasswordRules(passwordLogin.value, "login-");
      });

      // Validación al enviar el formulario de LOGIN
      loginForm.addEventListener("submit", function (event) {
        if (!isEmailValid(emailLogin.value)) {
          event.preventDefault();
          alert("El correo electrónico no cumple el formato válido (usuario@dominio.com).");
          return;
        }
        if (!isPasswordValid(passwordLogin.value)) {
          event.preventDefault();
          alert("La contraseña no cumple los requisitos indicados.");
        }
      });

      // ---- REGISTRO ----
      const registerForm = document.getElementById("registerForm");
      const passwordReg = document.getElementById("passwordReg");

      passwordReg.addEventListener("focus", () => {
        document.getElementById("passwordRulesReg").style.display = "block";
      });
      passwordReg.addEventListener("blur", () => {
        document.getElementById("passwordRulesReg").style.display = "none";
      });
      passwordReg.addEventListener("input", () => {
        checkPasswordRules(passwordReg.value, "reg-");
      });

      registerForm.addEventListener("submit", function (event) {
        if (!isPasswordValid(passwordReg.value)) {
          event.preventDefault();
          alert("La contraseña no cumple los requisitos indicados.");
        }
      });

      // ---- Funciones de validación ----

      // Email: simple verificación de formato
      function isEmailValid(email) {
        // Regex sencilla: algo@algo.algo
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailRegex.test(email);
      }

      function checkEmailRulesLogin(email) {
        const ruleEl = document.getElementById("login-emailformat");
        // Si cumple, oculta el texto; si no, muéstralo
        if (isEmailValid(email)) {
          ruleEl.style.display = "none";
        } else {
          ruleEl.style.display = "block";
        }
      }

      // Contraseña
      function isPasswordValid(password) {
        return (
          password.length >= 8 &&
          /[A-Z]/.test(password) &&
          /\d/.test(password)
        );
      }

      function checkPasswordRules(password, prefix) {
        const lengthEl = document.getElementById(prefix + "length");
        const uppercaseEl = document.getElementById(prefix + "uppercase");
        const digitEl = document.getElementById(prefix + "digit");

        // Regla 1: longitud >= 8
        if (password.length >= 8) {
          lengthEl.style.display = "none";
        } else {
          lengthEl.style.display = "block";
        }

        // Regla 2: al menos 1 mayúscula
        if (/[A-Z]/.test(password)) {
          uppercaseEl.style.display = "none";
        } else {
          uppercaseEl.style.display = "block";
        }

        // Regla 3: al menos 1 dígito
        if (/\d/.test(password)) {
          digitEl.style.display = "none";
        } else {
          digitEl.style.display = "block";
        }
      }

      // Botones de Login con Google y GitHub
      document.getElementById("googleLogin").addEventListener("click", function () {
        window.location.href = "http://ambisensepruebaapi.us-east-1.elasticbeanstalk.com/oauth2/authorization/google";
      });

      document.getElementById("githubLogin").addEventListener("click", function () {
        window.location.href = "http://ambisensepruebaapi.us-east-1.elasticbeanstalk.com/oauth2/authorization/github";
      });
    });
  </script>
</body>
</html>
